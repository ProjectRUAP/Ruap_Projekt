<?php

$dimen = 256;
$MODE = 1;
$cols = 32;
$blocks = 8;
$DEBUG = 0;

$extd = -1;
$generic = 0;

if(strlen($_POST["slika"]) > 0){
	$extd = 1;
	$generic = 1;
}else{
	if($_FILES["file"]["type"] == "image/jpeg" || $_FILES["file"]["type"] == "image/jpg") $extd = 1;
	if($_FILES["file"]["type"] == "image/png") $extd = 0;
}

if($MODE == 0){
	$blocks = 8;
}else{
	$cols = 32;
}

$fplocice = $images."/plocice";
$fimage =  $images."/temp";

@include "proces.php";

$_SESSION["slika_url"] = "";
$RGBsite = 'https://europewest.services.azureml.net/workspaces/5986524072b54d548170883678b6e32a/services/fc06074f3fce4d5cb41e4efd6f95726e/execute?api-version=2.0&details=true';
$RGBAPIKey = '+B1mA/YVtgsWTww5tX4HDs6iL2g7Pivchror93WEI9O7q4gT19jYUo2cUIHUzIo3mLAqh9zcr2GWYzWQbFlT1g==';

$DCTsite = 'https://europewest.services.azureml.net/workspaces/5986524072b54d548170883678b6e32a/services/f59bd9b2243e48d3ac33251c398122ce/execute?api-version=2.0&details=true';
$DCTAPIKey = 'tbZRXsvRW4Xxjx85BJ52kSJRvNIw28RVolKDsTKRRTYZFLYyTqPvveHq30MpQGbZzhFfdam8LRhnY64hcgVA1A==';

if($MODE == 0){
	$site = $DCTsite;
	$APIKey = $DCTAPIKey;
}
else{
	$site = $RGBsite;
	$APIKey = $RGBAPIKey;
}



$allowedExts = array("jpg", "jpeg", "png");
$nameArray = explode(".", $_FILES["file"]["name"]);
if ( $generic || ((($_FILES["file"]["type"] == "image/jpg")
	|| ($_FILES["file"]["type"] == "image/png")
	|| ($_FILES["file"]["type"] == "image/jpeg"))
	&& ($_FILES["file"]["size"] < 2000000)
	&& in_array(end($nameArray), $allowedExts))){
		  if (!$generic && $_FILES["file"]["error"] > 0){
			$process = "Greška: ".$_FILES["file"]["error"]."<br>";
		  }
		  else{ 
				if(!$generic){
					$Tdata = basename($nameArray[0]."-".date("dmyhis").".".end($nameArray));
					$Tfolder = $fimage."/".$Tdata;
					
				}
				else{
					$Tfolder = $_POST["slika"];
					$_SESSION["slika_url"] = $Tfolder;
					
				}
				
				if ($generic || !file_exists( $Tdata )){
					
					if(!$generic)
						if(move_uploaded_file($_FILES["file"]["tmp_name"], $Tfolder))
							$_SESSION["slika_url"] = $Tfolder;
						else $process .= "Greška: Slika nije učitana na server!<br>";
					
					
					if($DEBUG)switch(1){
							case 0: browseImages($fplocice,$data."/outputDCT128.csv",0); break;
							case 1: browseImages($fplocice,$data."/outputDCT128v8.csv",0); break;
							case 2: browseImages($fplocice,$data."/outputRGB16.csv",1); break;
							case 3: browseImages($fplocice,$data."/outputRGB32.csv",1); break;
							case 4: browseImages($fplocice,$data."/outputRGB16v8.csv",1); break;

						}
					else{
						if($MODE == 0)
							$postData  = JSONoutDCT(fetchCSV($Tfolder));
						else
							$postData  = JSONoutRGB(fetchCSV($Tfolder));
						$jsCount  = strlen($postData);
						//var_dump($postData) ;

						$ch = curl_init($site);
						curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
						curl_setopt($ch, CURLINFO_HEADER_OUT, true);
						curl_setopt_array($ch, array(
							CURLOPT_POST => TRUE,
							CURLOPT_RETURNTRANSFER => TRUE,
							CURLOPT_HTTPHEADER => array(
								'Authorization: Bearer '.$APIKey,
								'Content-Length: '.$jsCount,
								'Content-Type: application/json',
								'Accept: application/json'
							)
						));

						curl_setopt($ch, CURLOPT_POSTFIELDS, $postData);
						$response = curl_exec($ch);
						//var_dump($result = json_decode($response,true));
						$result = json_decode($response,true);
						if($MODE == 0)
							$result = $result["Results"]["output1"]["value"]["Values"][0][2058]; // DCT: 2058
						else 
							$result = $result["Results"]["output1"]["value"]["Values"][0][106]; // RGB: 58 , 106  DCT: 2058
						curl_close($ch);
						
						$_SESSION["rezz"] = $result;
			
						
						if($_SESSION["backsite"] == "pocetna"){
								
								$query= "SELECT count(rezz) as count FROM ".$db_testovi." WHERE test='".($result)."' AND rezz=1";
								//echo $query;
								if (!($q=@mysql_query($query)))
									$logerr = "2Neuspjelo slanje upita bazi!";
								if (@mysql_num_rows($q)==0 && !$logerr)
								  $logerr = "Prazan red!";
								else if(!$logerr){
								  while(($redak = @mysql_fetch_array($q) )) 
									  //echo var_dump($redak);
										$Kistih = $redak[0];
								}
								$query= "SELECT count(rezz) as count FROM ".$db_testovi." WHERE test='".($result)."'";
								//echo $query;
								if (!($q=@mysql_query($query)) && !$logerr)
									$logerr = "2Neuspjelo slanje upita bazi!";
								if (@mysql_num_rows($q)==0 && !$logerr)
								  $logerr = "Prazan red!";
								else if(!$logerr){
								  while(($redak = @mysql_fetch_array($q) )) 
									  //echo var_dump($redak);
										$_SESSION["postotak"] = floor($Kistih/$redak[0]*100);
								}
								
								
							}
						
						
					}
						
						if ($handle = opendir($fimage)) {
							while (false !== ($file = readdir($handle))) {
								if(!is_dir($file) && strcmp($file, $Tdata))
									unlink($fimage.'/'.$file);
							}
						}
						closedir($handle);
						
						//saveFile($data."/output.csv",$histo);
						
				} else $process .= "Greška: Datoteka postoji!!<br>";
			  
			}
}
else $process .= "Greška: Nepodržan format (Treba: jpg,jpeg,png) ili >2 MB<br>";




function inport($arr){
	$str = "";
	foreach($arr as $a)
		$str .= ('"'.$a.'",');
	return $str;
}


function JSONoutRGB($in1){
	return '{
  "Inputs": {
    "input1": {
      "ColumnNames": [
        "Col1",
        "Col2",
        "Col3",
        "Col4",
        "Col5",
        "Col6",
        "Col7",
        "Col8",
        "Col9",
        "Col10",
        "Col11",
        "Col12",
        "Col13",
        "Col14",
        "Col15",
        "Col16",
        "Col17",
        "Col18",
        "Col19",
        "Col20",
        "Col21",
        "Col22",
        "Col23",
        "Col24",
        "Col25",
        "Col26",
        "Col27",
        "Col28",
        "Col29",
        "Col30",
        "Col31",
        "Col32",
        "Col33",
        "Col34",
        "Col35",
        "Col36",
        "Col37",
        "Col38",
        "Col39",
        "Col40",
        "Col41",
        "Col42",
        "Col43",
        "Col44",
        "Col45",
        "Col46",
        "Col47",
        "Col48",
        "Col49",
        "Col50",
        "Col51",
        "Col52",
        "Col53",
        "Col54",
        "Col55",
        "Col56",
        "Col57",
        "Col58",
        "Col59",
        "Col60",
        "Col61",
        "Col62",
        "Col63",
        "Col64",
        "Col65",
        "Col66",
        "Col67",
        "Col68",
        "Col69",
        "Col70",
        "Col71",
        "Col72",
        "Col73",
        "Col74",
        "Col75",
        "Col76",
        "Col77",
        "Col78",
        "Col79",
        "Col80",
        "Col81",
        "Col82",
        "Col83",
        "Col84",
        "Col85",
        "Col86",
        "Col87",
        "Col88",
        "Col89",
        "Col90",
        "Col91",
        "Col92",
        "Col93",
        "Col94",
        "Col95",
        "Col96",
        "Col97"
      ],
      "Values": [
        [
'.inport($in1).'
          "null"
        ]
      ]
    }
  },
  "GlobalParameters": {}
}';
}

function JSONoutDCT($in1){
	return '{
  "Inputs": {
    "input1": {
      "ColumnNames": [
        "Col1",
        "Col2",
        "Col3",
        "Col4",
        "Col5",
        "Col6",
        "Col7",
        "Col8",
        "Col9",
        "Col10",
        "Col11",
        "Col12",
        "Col13",
        "Col14",
        "Col15",
        "Col16",
        "Col17",
        "Col18",
        "Col19",
        "Col20",
        "Col21",
        "Col22",
        "Col23",
        "Col24",
        "Col25",
        "Col26",
        "Col27",
        "Col28",
        "Col29",
        "Col30",
        "Col31",
        "Col32",
        "Col33",
        "Col34",
        "Col35",
        "Col36",
        "Col37",
        "Col38",
        "Col39",
        "Col40",
        "Col41",
        "Col42",
        "Col43",
        "Col44",
        "Col45",
        "Col46",
        "Col47",
        "Col48",
        "Col49",
        "Col50",
        "Col51",
        "Col52",
        "Col53",
        "Col54",
        "Col55",
        "Col56",
        "Col57",
        "Col58",
        "Col59",
        "Col60",
        "Col61",
        "Col62",
        "Col63",
        "Col64",
        "Col65",
        "Col66",
        "Col67",
        "Col68",
        "Col69",
        "Col70",
        "Col71",
        "Col72",
        "Col73",
        "Col74",
        "Col75",
        "Col76",
        "Col77",
        "Col78",
        "Col79",
        "Col80",
        "Col81",
        "Col82",
        "Col83",
        "Col84",
        "Col85",
        "Col86",
        "Col87",
        "Col88",
        "Col89",
        "Col90",
        "Col91",
        "Col92",
        "Col93",
        "Col94",
        "Col95",
        "Col96",
        "Col97",
        "Col98",
        "Col99",
        "Col100",
        "Col101",
        "Col102",
        "Col103",
        "Col104",
        "Col105",
        "Col106",
        "Col107",
        "Col108",
        "Col109",
        "Col110",
        "Col111",
        "Col112",
        "Col113",
        "Col114",
        "Col115",
        "Col116",
        "Col117",
        "Col118",
        "Col119",
        "Col120",
        "Col121",
        "Col122",
        "Col123",
        "Col124",
        "Col125",
        "Col126",
        "Col127",
        "Col128",
        "Col129",
        "Col130",
        "Col131",
        "Col132",
        "Col133",
        "Col134",
        "Col135",
        "Col136",
        "Col137",
        "Col138",
        "Col139",
        "Col140",
        "Col141",
        "Col142",
        "Col143",
        "Col144",
        "Col145",
        "Col146",
        "Col147",
        "Col148",
        "Col149",
        "Col150",
        "Col151",
        "Col152",
        "Col153",
        "Col154",
        "Col155",
        "Col156",
        "Col157",
        "Col158",
        "Col159",
        "Col160",
        "Col161",
        "Col162",
        "Col163",
        "Col164",
        "Col165",
        "Col166",
        "Col167",
        "Col168",
        "Col169",
        "Col170",
        "Col171",
        "Col172",
        "Col173",
        "Col174",
        "Col175",
        "Col176",
        "Col177",
        "Col178",
        "Col179",
        "Col180",
        "Col181",
        "Col182",
        "Col183",
        "Col184",
        "Col185",
        "Col186",
        "Col187",
        "Col188",
        "Col189",
        "Col190",
        "Col191",
        "Col192",
        "Col193",
        "Col194",
        "Col195",
        "Col196",
        "Col197",
        "Col198",
        "Col199",
        "Col200",
        "Col201",
        "Col202",
        "Col203",
        "Col204",
        "Col205",
        "Col206",
        "Col207",
        "Col208",
        "Col209",
        "Col210",
        "Col211",
        "Col212",
        "Col213",
        "Col214",
        "Col215",
        "Col216",
        "Col217",
        "Col218",
        "Col219",
        "Col220",
        "Col221",
        "Col222",
        "Col223",
        "Col224",
        "Col225",
        "Col226",
        "Col227",
        "Col228",
        "Col229",
        "Col230",
        "Col231",
        "Col232",
        "Col233",
        "Col234",
        "Col235",
        "Col236",
        "Col237",
        "Col238",
        "Col239",
        "Col240",
        "Col241",
        "Col242",
        "Col243",
        "Col244",
        "Col245",
        "Col246",
        "Col247",
        "Col248",
        "Col249",
        "Col250",
        "Col251",
        "Col252",
        "Col253",
        "Col254",
        "Col255",
        "Col256",
        "Col257",
        "Col258",
        "Col259",
        "Col260",
        "Col261",
        "Col262",
        "Col263",
        "Col264",
        "Col265",
        "Col266",
        "Col267",
        "Col268",
        "Col269",
        "Col270",
        "Col271",
        "Col272",
        "Col273",
        "Col274",
        "Col275",
        "Col276",
        "Col277",
        "Col278",
        "Col279",
        "Col280",
        "Col281",
        "Col282",
        "Col283",
        "Col284",
        "Col285",
        "Col286",
        "Col287",
        "Col288",
        "Col289",
        "Col290",
        "Col291",
        "Col292",
        "Col293",
        "Col294",
        "Col295",
        "Col296",
        "Col297",
        "Col298",
        "Col299",
        "Col300",
        "Col301",
        "Col302",
        "Col303",
        "Col304",
        "Col305",
        "Col306",
        "Col307",
        "Col308",
        "Col309",
        "Col310",
        "Col311",
        "Col312",
        "Col313",
        "Col314",
        "Col315",
        "Col316",
        "Col317",
        "Col318",
        "Col319",
        "Col320",
        "Col321",
        "Col322",
        "Col323",
        "Col324",
        "Col325",
        "Col326",
        "Col327",
        "Col328",
        "Col329",
        "Col330",
        "Col331",
        "Col332",
        "Col333",
        "Col334",
        "Col335",
        "Col336",
        "Col337",
        "Col338",
        "Col339",
        "Col340",
        "Col341",
        "Col342",
        "Col343",
        "Col344",
        "Col345",
        "Col346",
        "Col347",
        "Col348",
        "Col349",
        "Col350",
        "Col351",
        "Col352",
        "Col353",
        "Col354",
        "Col355",
        "Col356",
        "Col357",
        "Col358",
        "Col359",
        "Col360",
        "Col361",
        "Col362",
        "Col363",
        "Col364",
        "Col365",
        "Col366",
        "Col367",
        "Col368",
        "Col369",
        "Col370",
        "Col371",
        "Col372",
        "Col373",
        "Col374",
        "Col375",
        "Col376",
        "Col377",
        "Col378",
        "Col379",
        "Col380",
        "Col381",
        "Col382",
        "Col383",
        "Col384",
        "Col385",
        "Col386",
        "Col387",
        "Col388",
        "Col389",
        "Col390",
        "Col391",
        "Col392",
        "Col393",
        "Col394",
        "Col395",
        "Col396",
        "Col397",
        "Col398",
        "Col399",
        "Col400",
        "Col401",
        "Col402",
        "Col403",
        "Col404",
        "Col405",
        "Col406",
        "Col407",
        "Col408",
        "Col409",
        "Col410",
        "Col411",
        "Col412",
        "Col413",
        "Col414",
        "Col415",
        "Col416",
        "Col417",
        "Col418",
        "Col419",
        "Col420",
        "Col421",
        "Col422",
        "Col423",
        "Col424",
        "Col425",
        "Col426",
        "Col427",
        "Col428",
        "Col429",
        "Col430",
        "Col431",
        "Col432",
        "Col433",
        "Col434",
        "Col435",
        "Col436",
        "Col437",
        "Col438",
        "Col439",
        "Col440",
        "Col441",
        "Col442",
        "Col443",
        "Col444",
        "Col445",
        "Col446",
        "Col447",
        "Col448",
        "Col449",
        "Col450",
        "Col451",
        "Col452",
        "Col453",
        "Col454",
        "Col455",
        "Col456",
        "Col457",
        "Col458",
        "Col459",
        "Col460",
        "Col461",
        "Col462",
        "Col463",
        "Col464",
        "Col465",
        "Col466",
        "Col467",
        "Col468",
        "Col469",
        "Col470",
        "Col471",
        "Col472",
        "Col473",
        "Col474",
        "Col475",
        "Col476",
        "Col477",
        "Col478",
        "Col479",
        "Col480",
        "Col481",
        "Col482",
        "Col483",
        "Col484",
        "Col485",
        "Col486",
        "Col487",
        "Col488",
        "Col489",
        "Col490",
        "Col491",
        "Col492",
        "Col493",
        "Col494",
        "Col495",
        "Col496",
        "Col497",
        "Col498",
        "Col499",
        "Col500",
        "Col501",
        "Col502",
        "Col503",
        "Col504",
        "Col505",
        "Col506",
        "Col507",
        "Col508",
        "Col509",
        "Col510",
        "Col511",
        "Col512",
        "Col513",
        "Col514",
        "Col515",
        "Col516",
        "Col517",
        "Col518",
        "Col519",
        "Col520",
        "Col521",
        "Col522",
        "Col523",
        "Col524",
        "Col525",
        "Col526",
        "Col527",
        "Col528",
        "Col529",
        "Col530",
        "Col531",
        "Col532",
        "Col533",
        "Col534",
        "Col535",
        "Col536",
        "Col537",
        "Col538",
        "Col539",
        "Col540",
        "Col541",
        "Col542",
        "Col543",
        "Col544",
        "Col545",
        "Col546",
        "Col547",
        "Col548",
        "Col549",
        "Col550",
        "Col551",
        "Col552",
        "Col553",
        "Col554",
        "Col555",
        "Col556",
        "Col557",
        "Col558",
        "Col559",
        "Col560",
        "Col561",
        "Col562",
        "Col563",
        "Col564",
        "Col565",
        "Col566",
        "Col567",
        "Col568",
        "Col569",
        "Col570",
        "Col571",
        "Col572",
        "Col573",
        "Col574",
        "Col575",
        "Col576",
        "Col577",
        "Col578",
        "Col579",
        "Col580",
        "Col581",
        "Col582",
        "Col583",
        "Col584",
        "Col585",
        "Col586",
        "Col587",
        "Col588",
        "Col589",
        "Col590",
        "Col591",
        "Col592",
        "Col593",
        "Col594",
        "Col595",
        "Col596",
        "Col597",
        "Col598",
        "Col599",
        "Col600",
        "Col601",
        "Col602",
        "Col603",
        "Col604",
        "Col605",
        "Col606",
        "Col607",
        "Col608",
        "Col609",
        "Col610",
        "Col611",
        "Col612",
        "Col613",
        "Col614",
        "Col615",
        "Col616",
        "Col617",
        "Col618",
        "Col619",
        "Col620",
        "Col621",
        "Col622",
        "Col623",
        "Col624",
        "Col625",
        "Col626",
        "Col627",
        "Col628",
        "Col629",
        "Col630",
        "Col631",
        "Col632",
        "Col633",
        "Col634",
        "Col635",
        "Col636",
        "Col637",
        "Col638",
        "Col639",
        "Col640",
        "Col641",
        "Col642",
        "Col643",
        "Col644",
        "Col645",
        "Col646",
        "Col647",
        "Col648",
        "Col649",
        "Col650",
        "Col651",
        "Col652",
        "Col653",
        "Col654",
        "Col655",
        "Col656",
        "Col657",
        "Col658",
        "Col659",
        "Col660",
        "Col661",
        "Col662",
        "Col663",
        "Col664",
        "Col665",
        "Col666",
        "Col667",
        "Col668",
        "Col669",
        "Col670",
        "Col671",
        "Col672",
        "Col673",
        "Col674",
        "Col675",
        "Col676",
        "Col677",
        "Col678",
        "Col679",
        "Col680",
        "Col681",
        "Col682",
        "Col683",
        "Col684",
        "Col685",
        "Col686",
        "Col687",
        "Col688",
        "Col689",
        "Col690",
        "Col691",
        "Col692",
        "Col693",
        "Col694",
        "Col695",
        "Col696",
        "Col697",
        "Col698",
        "Col699",
        "Col700",
        "Col701",
        "Col702",
        "Col703",
        "Col704",
        "Col705",
        "Col706",
        "Col707",
        "Col708",
        "Col709",
        "Col710",
        "Col711",
        "Col712",
        "Col713",
        "Col714",
        "Col715",
        "Col716",
        "Col717",
        "Col718",
        "Col719",
        "Col720",
        "Col721",
        "Col722",
        "Col723",
        "Col724",
        "Col725",
        "Col726",
        "Col727",
        "Col728",
        "Col729",
        "Col730",
        "Col731",
        "Col732",
        "Col733",
        "Col734",
        "Col735",
        "Col736",
        "Col737",
        "Col738",
        "Col739",
        "Col740",
        "Col741",
        "Col742",
        "Col743",
        "Col744",
        "Col745",
        "Col746",
        "Col747",
        "Col748",
        "Col749",
        "Col750",
        "Col751",
        "Col752",
        "Col753",
        "Col754",
        "Col755",
        "Col756",
        "Col757",
        "Col758",
        "Col759",
        "Col760",
        "Col761",
        "Col762",
        "Col763",
        "Col764",
        "Col765",
        "Col766",
        "Col767",
        "Col768",
        "Col769",
        "Col770",
        "Col771",
        "Col772",
        "Col773",
        "Col774",
        "Col775",
        "Col776",
        "Col777",
        "Col778",
        "Col779",
        "Col780",
        "Col781",
        "Col782",
        "Col783",
        "Col784",
        "Col785",
        "Col786",
        "Col787",
        "Col788",
        "Col789",
        "Col790",
        "Col791",
        "Col792",
        "Col793",
        "Col794",
        "Col795",
        "Col796",
        "Col797",
        "Col798",
        "Col799",
        "Col800",
        "Col801",
        "Col802",
        "Col803",
        "Col804",
        "Col805",
        "Col806",
        "Col807",
        "Col808",
        "Col809",
        "Col810",
        "Col811",
        "Col812",
        "Col813",
        "Col814",
        "Col815",
        "Col816",
        "Col817",
        "Col818",
        "Col819",
        "Col820",
        "Col821",
        "Col822",
        "Col823",
        "Col824",
        "Col825",
        "Col826",
        "Col827",
        "Col828",
        "Col829",
        "Col830",
        "Col831",
        "Col832",
        "Col833",
        "Col834",
        "Col835",
        "Col836",
        "Col837",
        "Col838",
        "Col839",
        "Col840",
        "Col841",
        "Col842",
        "Col843",
        "Col844",
        "Col845",
        "Col846",
        "Col847",
        "Col848",
        "Col849",
        "Col850",
        "Col851",
        "Col852",
        "Col853",
        "Col854",
        "Col855",
        "Col856",
        "Col857",
        "Col858",
        "Col859",
        "Col860",
        "Col861",
        "Col862",
        "Col863",
        "Col864",
        "Col865",
        "Col866",
        "Col867",
        "Col868",
        "Col869",
        "Col870",
        "Col871",
        "Col872",
        "Col873",
        "Col874",
        "Col875",
        "Col876",
        "Col877",
        "Col878",
        "Col879",
        "Col880",
        "Col881",
        "Col882",
        "Col883",
        "Col884",
        "Col885",
        "Col886",
        "Col887",
        "Col888",
        "Col889",
        "Col890",
        "Col891",
        "Col892",
        "Col893",
        "Col894",
        "Col895",
        "Col896",
        "Col897",
        "Col898",
        "Col899",
        "Col900",
        "Col901",
        "Col902",
        "Col903",
        "Col904",
        "Col905",
        "Col906",
        "Col907",
        "Col908",
        "Col909",
        "Col910",
        "Col911",
        "Col912",
        "Col913",
        "Col914",
        "Col915",
        "Col916",
        "Col917",
        "Col918",
        "Col919",
        "Col920",
        "Col921",
        "Col922",
        "Col923",
        "Col924",
        "Col925",
        "Col926",
        "Col927",
        "Col928",
        "Col929",
        "Col930",
        "Col931",
        "Col932",
        "Col933",
        "Col934",
        "Col935",
        "Col936",
        "Col937",
        "Col938",
        "Col939",
        "Col940",
        "Col941",
        "Col942",
        "Col943",
        "Col944",
        "Col945",
        "Col946",
        "Col947",
        "Col948",
        "Col949",
        "Col950",
        "Col951",
        "Col952",
        "Col953",
        "Col954",
        "Col955",
        "Col956",
        "Col957",
        "Col958",
        "Col959",
        "Col960",
        "Col961",
        "Col962",
        "Col963",
        "Col964",
        "Col965",
        "Col966",
        "Col967",
        "Col968",
        "Col969",
        "Col970",
        "Col971",
        "Col972",
        "Col973",
        "Col974",
        "Col975",
        "Col976",
        "Col977",
        "Col978",
        "Col979",
        "Col980",
        "Col981",
        "Col982",
        "Col983",
        "Col984",
        "Col985",
        "Col986",
        "Col987",
        "Col988",
        "Col989",
        "Col990",
        "Col991",
        "Col992",
        "Col993",
        "Col994",
        "Col995",
        "Col996",
        "Col997",
        "Col998",
        "Col999",
        "Col1000",
        "Col1001",
        "Col1002",
        "Col1003",
        "Col1004",
        "Col1005",
        "Col1006",
        "Col1007",
        "Col1008",
        "Col1009",
        "Col1010",
        "Col1011",
        "Col1012",
        "Col1013",
        "Col1014",
        "Col1015",
        "Col1016",
        "Col1017",
        "Col1018",
        "Col1019",
        "Col1020",
        "Col1021",
        "Col1022",
        "Col1023",
        "Col1024",
        "Col1025",
        "Col1026",
        "Col1027",
        "Col1028",
        "Col1029",
        "Col1030",
        "Col1031",
        "Col1032",
        "Col1033",
        "Col1034",
        "Col1035",
        "Col1036",
        "Col1037",
        "Col1038",
        "Col1039",
        "Col1040",
        "Col1041",
        "Col1042",
        "Col1043",
        "Col1044",
        "Col1045",
        "Col1046",
        "Col1047",
        "Col1048",
        "Col1049",
        "Col1050",
        "Col1051",
        "Col1052",
        "Col1053",
        "Col1054",
        "Col1055",
        "Col1056",
        "Col1057",
        "Col1058",
        "Col1059",
        "Col1060",
        "Col1061",
        "Col1062",
        "Col1063",
        "Col1064",
        "Col1065",
        "Col1066",
        "Col1067",
        "Col1068",
        "Col1069",
        "Col1070",
        "Col1071",
        "Col1072",
        "Col1073",
        "Col1074",
        "Col1075",
        "Col1076",
        "Col1077",
        "Col1078",
        "Col1079",
        "Col1080",
        "Col1081",
        "Col1082",
        "Col1083",
        "Col1084",
        "Col1085",
        "Col1086",
        "Col1087",
        "Col1088",
        "Col1089",
        "Col1090",
        "Col1091",
        "Col1092",
        "Col1093",
        "Col1094",
        "Col1095",
        "Col1096",
        "Col1097",
        "Col1098",
        "Col1099",
        "Col1100",
        "Col1101",
        "Col1102",
        "Col1103",
        "Col1104",
        "Col1105",
        "Col1106",
        "Col1107",
        "Col1108",
        "Col1109",
        "Col1110",
        "Col1111",
        "Col1112",
        "Col1113",
        "Col1114",
        "Col1115",
        "Col1116",
        "Col1117",
        "Col1118",
        "Col1119",
        "Col1120",
        "Col1121",
        "Col1122",
        "Col1123",
        "Col1124",
        "Col1125",
        "Col1126",
        "Col1127",
        "Col1128",
        "Col1129",
        "Col1130",
        "Col1131",
        "Col1132",
        "Col1133",
        "Col1134",
        "Col1135",
        "Col1136",
        "Col1137",
        "Col1138",
        "Col1139",
        "Col1140",
        "Col1141",
        "Col1142",
        "Col1143",
        "Col1144",
        "Col1145",
        "Col1146",
        "Col1147",
        "Col1148",
        "Col1149",
        "Col1150",
        "Col1151",
        "Col1152",
        "Col1153",
        "Col1154",
        "Col1155",
        "Col1156",
        "Col1157",
        "Col1158",
        "Col1159",
        "Col1160",
        "Col1161",
        "Col1162",
        "Col1163",
        "Col1164",
        "Col1165",
        "Col1166",
        "Col1167",
        "Col1168",
        "Col1169",
        "Col1170",
        "Col1171",
        "Col1172",
        "Col1173",
        "Col1174",
        "Col1175",
        "Col1176",
        "Col1177",
        "Col1178",
        "Col1179",
        "Col1180",
        "Col1181",
        "Col1182",
        "Col1183",
        "Col1184",
        "Col1185",
        "Col1186",
        "Col1187",
        "Col1188",
        "Col1189",
        "Col1190",
        "Col1191",
        "Col1192",
        "Col1193",
        "Col1194",
        "Col1195",
        "Col1196",
        "Col1197",
        "Col1198",
        "Col1199",
        "Col1200",
        "Col1201",
        "Col1202",
        "Col1203",
        "Col1204",
        "Col1205",
        "Col1206",
        "Col1207",
        "Col1208",
        "Col1209",
        "Col1210",
        "Col1211",
        "Col1212",
        "Col1213",
        "Col1214",
        "Col1215",
        "Col1216",
        "Col1217",
        "Col1218",
        "Col1219",
        "Col1220",
        "Col1221",
        "Col1222",
        "Col1223",
        "Col1224",
        "Col1225",
        "Col1226",
        "Col1227",
        "Col1228",
        "Col1229",
        "Col1230",
        "Col1231",
        "Col1232",
        "Col1233",
        "Col1234",
        "Col1235",
        "Col1236",
        "Col1237",
        "Col1238",
        "Col1239",
        "Col1240",
        "Col1241",
        "Col1242",
        "Col1243",
        "Col1244",
        "Col1245",
        "Col1246",
        "Col1247",
        "Col1248",
        "Col1249",
        "Col1250",
        "Col1251",
        "Col1252",
        "Col1253",
        "Col1254",
        "Col1255",
        "Col1256",
        "Col1257",
        "Col1258",
        "Col1259",
        "Col1260",
        "Col1261",
        "Col1262",
        "Col1263",
        "Col1264",
        "Col1265",
        "Col1266",
        "Col1267",
        "Col1268",
        "Col1269",
        "Col1270",
        "Col1271",
        "Col1272",
        "Col1273",
        "Col1274",
        "Col1275",
        "Col1276",
        "Col1277",
        "Col1278",
        "Col1279",
        "Col1280",
        "Col1281",
        "Col1282",
        "Col1283",
        "Col1284",
        "Col1285",
        "Col1286",
        "Col1287",
        "Col1288",
        "Col1289",
        "Col1290",
        "Col1291",
        "Col1292",
        "Col1293",
        "Col1294",
        "Col1295",
        "Col1296",
        "Col1297",
        "Col1298",
        "Col1299",
        "Col1300",
        "Col1301",
        "Col1302",
        "Col1303",
        "Col1304",
        "Col1305",
        "Col1306",
        "Col1307",
        "Col1308",
        "Col1309",
        "Col1310",
        "Col1311",
        "Col1312",
        "Col1313",
        "Col1314",
        "Col1315",
        "Col1316",
        "Col1317",
        "Col1318",
        "Col1319",
        "Col1320",
        "Col1321",
        "Col1322",
        "Col1323",
        "Col1324",
        "Col1325",
        "Col1326",
        "Col1327",
        "Col1328",
        "Col1329",
        "Col1330",
        "Col1331",
        "Col1332",
        "Col1333",
        "Col1334",
        "Col1335",
        "Col1336",
        "Col1337",
        "Col1338",
        "Col1339",
        "Col1340",
        "Col1341",
        "Col1342",
        "Col1343",
        "Col1344",
        "Col1345",
        "Col1346",
        "Col1347",
        "Col1348",
        "Col1349",
        "Col1350",
        "Col1351",
        "Col1352",
        "Col1353",
        "Col1354",
        "Col1355",
        "Col1356",
        "Col1357",
        "Col1358",
        "Col1359",
        "Col1360",
        "Col1361",
        "Col1362",
        "Col1363",
        "Col1364",
        "Col1365",
        "Col1366",
        "Col1367",
        "Col1368",
        "Col1369",
        "Col1370",
        "Col1371",
        "Col1372",
        "Col1373",
        "Col1374",
        "Col1375",
        "Col1376",
        "Col1377",
        "Col1378",
        "Col1379",
        "Col1380",
        "Col1381",
        "Col1382",
        "Col1383",
        "Col1384",
        "Col1385",
        "Col1386",
        "Col1387",
        "Col1388",
        "Col1389",
        "Col1390",
        "Col1391",
        "Col1392",
        "Col1393",
        "Col1394",
        "Col1395",
        "Col1396",
        "Col1397",
        "Col1398",
        "Col1399",
        "Col1400",
        "Col1401",
        "Col1402",
        "Col1403",
        "Col1404",
        "Col1405",
        "Col1406",
        "Col1407",
        "Col1408",
        "Col1409",
        "Col1410",
        "Col1411",
        "Col1412",
        "Col1413",
        "Col1414",
        "Col1415",
        "Col1416",
        "Col1417",
        "Col1418",
        "Col1419",
        "Col1420",
        "Col1421",
        "Col1422",
        "Col1423",
        "Col1424",
        "Col1425",
        "Col1426",
        "Col1427",
        "Col1428",
        "Col1429",
        "Col1430",
        "Col1431",
        "Col1432",
        "Col1433",
        "Col1434",
        "Col1435",
        "Col1436",
        "Col1437",
        "Col1438",
        "Col1439",
        "Col1440",
        "Col1441",
        "Col1442",
        "Col1443",
        "Col1444",
        "Col1445",
        "Col1446",
        "Col1447",
        "Col1448",
        "Col1449",
        "Col1450",
        "Col1451",
        "Col1452",
        "Col1453",
        "Col1454",
        "Col1455",
        "Col1456",
        "Col1457",
        "Col1458",
        "Col1459",
        "Col1460",
        "Col1461",
        "Col1462",
        "Col1463",
        "Col1464",
        "Col1465",
        "Col1466",
        "Col1467",
        "Col1468",
        "Col1469",
        "Col1470",
        "Col1471",
        "Col1472",
        "Col1473",
        "Col1474",
        "Col1475",
        "Col1476",
        "Col1477",
        "Col1478",
        "Col1479",
        "Col1480",
        "Col1481",
        "Col1482",
        "Col1483",
        "Col1484",
        "Col1485",
        "Col1486",
        "Col1487",
        "Col1488",
        "Col1489",
        "Col1490",
        "Col1491",
        "Col1492",
        "Col1493",
        "Col1494",
        "Col1495",
        "Col1496",
        "Col1497",
        "Col1498",
        "Col1499",
        "Col1500",
        "Col1501",
        "Col1502",
        "Col1503",
        "Col1504",
        "Col1505",
        "Col1506",
        "Col1507",
        "Col1508",
        "Col1509",
        "Col1510",
        "Col1511",
        "Col1512",
        "Col1513",
        "Col1514",
        "Col1515",
        "Col1516",
        "Col1517",
        "Col1518",
        "Col1519",
        "Col1520",
        "Col1521",
        "Col1522",
        "Col1523",
        "Col1524",
        "Col1525",
        "Col1526",
        "Col1527",
        "Col1528",
        "Col1529",
        "Col1530",
        "Col1531",
        "Col1532",
        "Col1533",
        "Col1534",
        "Col1535",
        "Col1536",
        "Col1537",
        "Col1538",
        "Col1539",
        "Col1540",
        "Col1541",
        "Col1542",
        "Col1543",
        "Col1544",
        "Col1545",
        "Col1546",
        "Col1547",
        "Col1548",
        "Col1549",
        "Col1550",
        "Col1551",
        "Col1552",
        "Col1553",
        "Col1554",
        "Col1555",
        "Col1556",
        "Col1557",
        "Col1558",
        "Col1559",
        "Col1560",
        "Col1561",
        "Col1562",
        "Col1563",
        "Col1564",
        "Col1565",
        "Col1566",
        "Col1567",
        "Col1568",
        "Col1569",
        "Col1570",
        "Col1571",
        "Col1572",
        "Col1573",
        "Col1574",
        "Col1575",
        "Col1576",
        "Col1577",
        "Col1578",
        "Col1579",
        "Col1580",
        "Col1581",
        "Col1582",
        "Col1583",
        "Col1584",
        "Col1585",
        "Col1586",
        "Col1587",
        "Col1588",
        "Col1589",
        "Col1590",
        "Col1591",
        "Col1592",
        "Col1593",
        "Col1594",
        "Col1595",
        "Col1596",
        "Col1597",
        "Col1598",
        "Col1599",
        "Col1600",
        "Col1601",
        "Col1602",
        "Col1603",
        "Col1604",
        "Col1605",
        "Col1606",
        "Col1607",
        "Col1608",
        "Col1609",
        "Col1610",
        "Col1611",
        "Col1612",
        "Col1613",
        "Col1614",
        "Col1615",
        "Col1616",
        "Col1617",
        "Col1618",
        "Col1619",
        "Col1620",
        "Col1621",
        "Col1622",
        "Col1623",
        "Col1624",
        "Col1625",
        "Col1626",
        "Col1627",
        "Col1628",
        "Col1629",
        "Col1630",
        "Col1631",
        "Col1632",
        "Col1633",
        "Col1634",
        "Col1635",
        "Col1636",
        "Col1637",
        "Col1638",
        "Col1639",
        "Col1640",
        "Col1641",
        "Col1642",
        "Col1643",
        "Col1644",
        "Col1645",
        "Col1646",
        "Col1647",
        "Col1648",
        "Col1649",
        "Col1650",
        "Col1651",
        "Col1652",
        "Col1653",
        "Col1654",
        "Col1655",
        "Col1656",
        "Col1657",
        "Col1658",
        "Col1659",
        "Col1660",
        "Col1661",
        "Col1662",
        "Col1663",
        "Col1664",
        "Col1665",
        "Col1666",
        "Col1667",
        "Col1668",
        "Col1669",
        "Col1670",
        "Col1671",
        "Col1672",
        "Col1673",
        "Col1674",
        "Col1675",
        "Col1676",
        "Col1677",
        "Col1678",
        "Col1679",
        "Col1680",
        "Col1681",
        "Col1682",
        "Col1683",
        "Col1684",
        "Col1685",
        "Col1686",
        "Col1687",
        "Col1688",
        "Col1689",
        "Col1690",
        "Col1691",
        "Col1692",
        "Col1693",
        "Col1694",
        "Col1695",
        "Col1696",
        "Col1697",
        "Col1698",
        "Col1699",
        "Col1700",
        "Col1701",
        "Col1702",
        "Col1703",
        "Col1704",
        "Col1705",
        "Col1706",
        "Col1707",
        "Col1708",
        "Col1709",
        "Col1710",
        "Col1711",
        "Col1712",
        "Col1713",
        "Col1714",
        "Col1715",
        "Col1716",
        "Col1717",
        "Col1718",
        "Col1719",
        "Col1720",
        "Col1721",
        "Col1722",
        "Col1723",
        "Col1724",
        "Col1725",
        "Col1726",
        "Col1727",
        "Col1728",
        "Col1729",
        "Col1730",
        "Col1731",
        "Col1732",
        "Col1733",
        "Col1734",
        "Col1735",
        "Col1736",
        "Col1737",
        "Col1738",
        "Col1739",
        "Col1740",
        "Col1741",
        "Col1742",
        "Col1743",
        "Col1744",
        "Col1745",
        "Col1746",
        "Col1747",
        "Col1748",
        "Col1749",
        "Col1750",
        "Col1751",
        "Col1752",
        "Col1753",
        "Col1754",
        "Col1755",
        "Col1756",
        "Col1757",
        "Col1758",
        "Col1759",
        "Col1760",
        "Col1761",
        "Col1762",
        "Col1763",
        "Col1764",
        "Col1765",
        "Col1766",
        "Col1767",
        "Col1768",
        "Col1769",
        "Col1770",
        "Col1771",
        "Col1772",
        "Col1773",
        "Col1774",
        "Col1775",
        "Col1776",
        "Col1777",
        "Col1778",
        "Col1779",
        "Col1780",
        "Col1781",
        "Col1782",
        "Col1783",
        "Col1784",
        "Col1785",
        "Col1786",
        "Col1787",
        "Col1788",
        "Col1789",
        "Col1790",
        "Col1791",
        "Col1792",
        "Col1793",
        "Col1794",
        "Col1795",
        "Col1796",
        "Col1797",
        "Col1798",
        "Col1799",
        "Col1800",
        "Col1801",
        "Col1802",
        "Col1803",
        "Col1804",
        "Col1805",
        "Col1806",
        "Col1807",
        "Col1808",
        "Col1809",
        "Col1810",
        "Col1811",
        "Col1812",
        "Col1813",
        "Col1814",
        "Col1815",
        "Col1816",
        "Col1817",
        "Col1818",
        "Col1819",
        "Col1820",
        "Col1821",
        "Col1822",
        "Col1823",
        "Col1824",
        "Col1825",
        "Col1826",
        "Col1827",
        "Col1828",
        "Col1829",
        "Col1830",
        "Col1831",
        "Col1832",
        "Col1833",
        "Col1834",
        "Col1835",
        "Col1836",
        "Col1837",
        "Col1838",
        "Col1839",
        "Col1840",
        "Col1841",
        "Col1842",
        "Col1843",
        "Col1844",
        "Col1845",
        "Col1846",
        "Col1847",
        "Col1848",
        "Col1849",
        "Col1850",
        "Col1851",
        "Col1852",
        "Col1853",
        "Col1854",
        "Col1855",
        "Col1856",
        "Col1857",
        "Col1858",
        "Col1859",
        "Col1860",
        "Col1861",
        "Col1862",
        "Col1863",
        "Col1864",
        "Col1865",
        "Col1866",
        "Col1867",
        "Col1868",
        "Col1869",
        "Col1870",
        "Col1871",
        "Col1872",
        "Col1873",
        "Col1874",
        "Col1875",
        "Col1876",
        "Col1877",
        "Col1878",
        "Col1879",
        "Col1880",
        "Col1881",
        "Col1882",
        "Col1883",
        "Col1884",
        "Col1885",
        "Col1886",
        "Col1887",
        "Col1888",
        "Col1889",
        "Col1890",
        "Col1891",
        "Col1892",
        "Col1893",
        "Col1894",
        "Col1895",
        "Col1896",
        "Col1897",
        "Col1898",
        "Col1899",
        "Col1900",
        "Col1901",
        "Col1902",
        "Col1903",
        "Col1904",
        "Col1905",
        "Col1906",
        "Col1907",
        "Col1908",
        "Col1909",
        "Col1910",
        "Col1911",
        "Col1912",
        "Col1913",
        "Col1914",
        "Col1915",
        "Col1916",
        "Col1917",
        "Col1918",
        "Col1919",
        "Col1920",
        "Col1921",
        "Col1922",
        "Col1923",
        "Col1924",
        "Col1925",
        "Col1926",
        "Col1927",
        "Col1928",
        "Col1929",
        "Col1930",
        "Col1931",
        "Col1932",
        "Col1933",
        "Col1934",
        "Col1935",
        "Col1936",
        "Col1937",
        "Col1938",
        "Col1939",
        "Col1940",
        "Col1941",
        "Col1942",
        "Col1943",
        "Col1944",
        "Col1945",
        "Col1946",
        "Col1947",
        "Col1948",
        "Col1949",
        "Col1950",
        "Col1951",
        "Col1952",
        "Col1953",
        "Col1954",
        "Col1955",
        "Col1956",
        "Col1957",
        "Col1958",
        "Col1959",
        "Col1960",
        "Col1961",
        "Col1962",
        "Col1963",
        "Col1964",
        "Col1965",
        "Col1966",
        "Col1967",
        "Col1968",
        "Col1969",
        "Col1970",
        "Col1971",
        "Col1972",
        "Col1973",
        "Col1974",
        "Col1975",
        "Col1976",
        "Col1977",
        "Col1978",
        "Col1979",
        "Col1980",
        "Col1981",
        "Col1982",
        "Col1983",
        "Col1984",
        "Col1985",
        "Col1986",
        "Col1987",
        "Col1988",
        "Col1989",
        "Col1990",
        "Col1991",
        "Col1992",
        "Col1993",
        "Col1994",
        "Col1995",
        "Col1996",
        "Col1997",
        "Col1998",
        "Col1999",
        "Col2000",
        "Col2001",
        "Col2002",
        "Col2003",
        "Col2004",
        "Col2005",
        "Col2006",
        "Col2007",
        "Col2008",
        "Col2009",
        "Col2010",
        "Col2011",
        "Col2012",
        "Col2013",
        "Col2014",
        "Col2015",
        "Col2016",
        "Col2017",
        "Col2018",
        "Col2019",
        "Col2020",
        "Col2021",
        "Col2022",
        "Col2023",
        "Col2024",
        "Col2025",
        "Col2026",
        "Col2027",
        "Col2028",
        "Col2029",
        "Col2030",
        "Col2031",
        "Col2032",
        "Col2033",
        "Col2034",
        "Col2035",
        "Col2036",
        "Col2037",
        "Col2038",
        "Col2039",
        "Col2040",
        "Col2041",
        "Col2042",
        "Col2043",
        "Col2044",
        "Col2045",
        "Col2046",
        "Col2047",
        "Col2048",
        "Col2049"
      ],
      "Values": [
        [
'.inport($in1).'
          "null"
        ]
      ]
    }
  },
  "GlobalParameters": {}
}';
}


?>